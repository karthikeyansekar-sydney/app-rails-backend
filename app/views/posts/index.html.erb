<p id="notice"><%= notice %></p>

<div class="btn btn-dark">
  <%= link_to 'New Post', new_post_path %>
</div>
<br>
<div class="feed">
  <% @posts.each do |post| %>
    <div class="post">
      <div>
        <%= link_to user_path(post.user.id) do %>

          <img class="avatar" src="<%= post.user.profile_pic %>" alt="<%= post.user_post %>">
        <% end%>
        <p><%= post.user.name %></p>
      </div>
      <div class="feed_header">
        <p><%= post.user_post %></p>

        <%= cl_image_tag(post.user_photo)  %>
        <p class="card-text">
          <small class="text-muted">Last updated <%= post.updated_at %></small>
        </p>

        <% if post.already_liked_by?(@current_user) %>
          <%= button_to 'Unlike', likes_path, method: :delete, params: {target_type:'post', target_id:post.id} %>
        <% else %>
          <%= button_to 'Like', likes_path, method: :post, params: {target_type:'post', target_id:post.id} %>
        <% end %>
        <%= post.likes.count %> <%= (post.likes.count) == 1 ? 'Like' : 'Likes'%>

        <% if post.already_disliked_by?(@current_user) %>
          <%= button_to 'Undislike', dislikes_path, method: :delete, params: {target_type:'post', target_id:post.id} %>
        <% else %>
          <%= button_to 'Dislike', dislikes_path, method: :post, params: {target_type:'post', target_id:post.id} %>
        <% end %>
        <%= post.dislikes.count %> <%= (post.dislikes.count) == 1 ? 'Dislike' : 'Dislikes'%>

        <br>
        

        <% if @current_user.present? && @current_user.admin %>
          <td><%= link_to 'Show', post, :class=>'btn btn-primary btn-sm' %></td>
          <td><%= link_to 'Edit', edit_post_path(post), :class=>'btn btn-secondary btn-sm' %></td>
          <td><%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' }, :class=>'btn btn-danger btn-sm'  %></td>
        <% end %>
      </div>
    </div>
    <% end%>
  </div>
